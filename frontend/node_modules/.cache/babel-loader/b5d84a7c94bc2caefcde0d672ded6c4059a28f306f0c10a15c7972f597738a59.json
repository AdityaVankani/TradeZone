{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Container,Grid,Card,CardContent,Typography,Button,Dialog,DialogTitle,DialogContent,DialogActions,TextField,List,ListItem,ListItemText}from'@mui/material';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Market=()=>{const[stocks,setStocks]=useState([]);const[selectedStock,setSelectedStock]=useState(null);const[orderType,setOrderType]=useState('buy');const[quantity,setQuantity]=useState('');const[price,setPrice]=useState('');const[openDialog,setOpenDialog]=useState(false);const[orders,setOrders]=useState([]);useEffect(()=>{fetchStocks();},[]);const fetchStocks=async()=>{try{const response=await axios.get('http://localhost:5000/api/stocks');setStocks(response.data);}catch(error){console.error('Error fetching stocks:',error);}};const handleOrderClick=(stock,type)=>{setSelectedStock(stock);setOrderType(type);setQuantity('');setPrice(type==='buy'?stock.current_price.toString():'');fetchOrders(stock.id,type==='buy'?'sell':'buy');setOpenDialog(true);};const fetchOrders=async(stockId,type)=>{try{const response=await axios.get(`http://localhost:5000/api/orders?stock_id=${stockId}&type=${type}`);setOrders(response.data);}catch(error){console.error('Error fetching orders:',error);}};const handlePlaceOrder=async()=>{if(!selectedStock)return;try{await axios.post('http://localhost:5000/api/orders',{stock_id:selectedStock.id,type:orderType,quantity:parseInt(quantity),price:parseFloat(price)});setOpenDialog(false);fetchStocks();// Refresh stocks after order\n}catch(error){console.error('Error placing order:',error);}};return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"Market\"}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,children:stocks.map(stock=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:stock.name}),/*#__PURE__*/_jsx(Typography,{color:\"textSecondary\",children:stock.symbol}),/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",sx:{my:2},children:[\"$\",stock.current_price.toFixed(2)]}),/*#__PURE__*/_jsxs(Typography,{color:stock.price_change>=0?'success.main':'error.main',children:[stock.price_change>=0?'+':'',stock.price_change.toFixed(2),\"%\"]}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:1,sx:{mt:2},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"contained\",color:\"primary\",onClick:()=>handleOrderClick(stock,'buy'),children:\"Buy\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,children:/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"contained\",color:\"secondary\",onClick:()=>handleOrderClick(stock,'sell'),children:\"Sell\"})})]})]})})},stock.id))}),/*#__PURE__*/_jsxs(Dialog,{open:openDialog,onClose:()=>setOpenDialog(false),maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsxs(DialogTitle,{children:[orderType==='buy'?'Buy':'Sell',\" \",selectedStock===null||selectedStock===void 0?void 0:selectedStock.name]}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Quantity\",type:\"number\",value:quantity,onChange:e=>setQuantity(e.target.value),margin:\"normal\"}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Price\",type:\"number\",value:price,onChange:e=>setPrice(e.target.value),margin:\"normal\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",sx:{mt:2},children:[orderType==='buy'?'Sell':'Buy',\" Orders\"]}),/*#__PURE__*/_jsx(List,{children:orders.map(order=>/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:`${order.quantity} shares at $${order.price}`})},order.id))})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setOpenDialog(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handlePlaceOrder,variant:\"contained\",color:\"primary\",children:\"Place Order\"})]})]})]});};export default Market;","map":{"version":3,"names":["React","useState","useEffect","Container","Grid","Card","CardContent","Typography","Button","Dialog","DialogTitle","DialogContent","DialogActions","TextField","List","ListItem","ListItemText","axios","jsx","_jsx","jsxs","_jsxs","Market","stocks","setStocks","selectedStock","setSelectedStock","orderType","setOrderType","quantity","setQuantity","price","setPrice","openDialog","setOpenDialog","orders","setOrders","fetchStocks","response","get","data","error","console","handleOrderClick","stock","type","current_price","toString","fetchOrders","id","stockId","handlePlaceOrder","post","stock_id","parseInt","parseFloat","children","variant","gutterBottom","container","spacing","map","item","xs","sm","md","name","color","symbol","sx","my","toFixed","price_change","mt","fullWidth","onClick","open","onClose","maxWidth","label","value","onChange","e","target","margin","order","primary"],"sources":["D:/Chesax/chesa-stock-exchange/chesa-stock-exchange/frontend/src/pages/Market.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport {\n  Container,\n  Grid,\n  Card,\n  CardContent,\n  Typography,\n  Button,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  TextField,\n  List,\n  ListItem,\n  ListItemText,\n} from '@mui/material';\nimport axios from 'axios';\n\ninterface Stock {\n  id: string;\n  name: string;\n  symbol: string;\n  current_price: number;\n  price_change: number;\n}\n\ninterface Order {\n  id: string;\n  stock_id: string;\n  type: 'buy' | 'sell';\n  quantity: number;\n  price: number;\n}\n\nconst Market = () => {\n  const [stocks, setStocks] = useState<Stock[]>([]);\n  const [selectedStock, setSelectedStock] = useState<Stock | null>(null);\n  const [orderType, setOrderType] = useState<'buy' | 'sell'>('buy');\n  const [quantity, setQuantity] = useState('');\n  const [price, setPrice] = useState('');\n  const [openDialog, setOpenDialog] = useState(false);\n  const [orders, setOrders] = useState<Order[]>([]);\n\n  useEffect(() => {\n    fetchStocks();\n  }, []);\n\n  const fetchStocks = async () => {\n    try {\n      const response = await axios.get('http://localhost:5000/api/stocks');\n      setStocks(response.data);\n    } catch (error) {\n      console.error('Error fetching stocks:', error);\n    }\n  };\n\n  const handleOrderClick = (stock: Stock, type: 'buy' | 'sell') => {\n    setSelectedStock(stock);\n    setOrderType(type);\n    setQuantity('');\n    setPrice(type === 'buy' ? stock.current_price.toString() : '');\n    fetchOrders(stock.id, type === 'buy' ? 'sell' : 'buy');\n    setOpenDialog(true);\n  };\n\n  const fetchOrders = async (stockId: string, type: 'buy' | 'sell') => {\n    try {\n      const response = await axios.get(`http://localhost:5000/api/orders?stock_id=${stockId}&type=${type}`);\n      setOrders(response.data);\n    } catch (error) {\n      console.error('Error fetching orders:', error);\n    }\n  };\n\n  const handlePlaceOrder = async () => {\n    if (!selectedStock) return;\n\n    try {\n      await axios.post('http://localhost:5000/api/orders', {\n        stock_id: selectedStock.id,\n        type: orderType,\n        quantity: parseInt(quantity),\n        price: parseFloat(price),\n      });\n      setOpenDialog(false);\n      fetchStocks(); // Refresh stocks after order\n    } catch (error) {\n      console.error('Error placing order:', error);\n    }\n  };\n\n  return (\n    <Container>\n      <Typography variant=\"h4\" gutterBottom>\n        Market\n      </Typography>\n      <Grid container spacing={3}>\n        {stocks.map((stock) => (\n          <Grid item xs={12} sm={6} md={4} key={stock.id}>\n            <Card>\n              <CardContent>\n                <Typography variant=\"h6\">{stock.name}</Typography>\n                <Typography color=\"textSecondary\">{stock.symbol}</Typography>\n                <Typography variant=\"h5\" sx={{ my: 2 }}>\n                  ${stock.current_price.toFixed(2)}\n                </Typography>\n                <Typography\n                  color={stock.price_change >= 0 ? 'success.main' : 'error.main'}\n                >\n                  {stock.price_change >= 0 ? '+' : ''}\n                  {stock.price_change.toFixed(2)}%\n                </Typography>\n                <Grid container spacing={1} sx={{ mt: 2 }}>\n                  <Grid item xs={6}>\n                    <Button\n                      fullWidth\n                      variant=\"contained\"\n                      color=\"primary\"\n                      onClick={() => handleOrderClick(stock, 'buy')}\n                    >\n                      Buy\n                    </Button>\n                  </Grid>\n                  <Grid item xs={6}>\n                    <Button\n                      fullWidth\n                      variant=\"contained\"\n                      color=\"secondary\"\n                      onClick={() => handleOrderClick(stock, 'sell')}\n                    >\n                      Sell\n                    </Button>\n                  </Grid>\n                </Grid>\n              </CardContent>\n            </Card>\n          </Grid>\n        ))}\n      </Grid>\n\n      <Dialog open={openDialog} onClose={() => setOpenDialog(false)} maxWidth=\"sm\" fullWidth>\n        <DialogTitle>\n          {orderType === 'buy' ? 'Buy' : 'Sell'} {selectedStock?.name}\n        </DialogTitle>\n        <DialogContent>\n          <TextField\n            fullWidth\n            label=\"Quantity\"\n            type=\"number\"\n            value={quantity}\n            onChange={(e) => setQuantity(e.target.value)}\n            margin=\"normal\"\n          />\n          <TextField\n            fullWidth\n            label=\"Price\"\n            type=\"number\"\n            value={price}\n            onChange={(e) => setPrice(e.target.value)}\n            margin=\"normal\"\n          />\n          <Typography variant=\"h6\" sx={{ mt: 2 }}>\n            {orderType === 'buy' ? 'Sell' : 'Buy'} Orders\n          </Typography>\n          <List>\n            {orders.map((order) => (\n              <ListItem key={order.id}>\n                <ListItemText\n                  primary={`${order.quantity} shares at $${order.price}`}\n                />\n              </ListItem>\n            ))}\n          </List>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setOpenDialog(false)}>Cancel</Button>\n          <Button onClick={handlePlaceOrder} variant=\"contained\" color=\"primary\">\n            Place Order\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </Container>\n  );\n};\n\nexport default Market;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}